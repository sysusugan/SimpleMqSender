import org.apache.activemq.ActiveMQConnectionFactory;import javax.jms.*;/** * 简单的ActiveMQ发送消息类. * * @author sugan * @since 14-6-17 */public class SimpleMqSender {    private Connection connection = null;    private Session session;    private MessageProducer producer;    public SimpleMqSender(String brokerUrl, String dest) {        ConnectionFactory connectionFactory = new ActiveMQConnectionFactory(brokerUrl);        try {            connection = connectionFactory.createConnection();            connection.start();            session = connection.createSession(Boolean.TRUE, Session.AUTO_ACKNOWLEDGE);            Destination destination = session.createQueue(dest);            producer = session.createProducer(destination);            producer.setDeliveryMode(DeliveryMode.NON_PERSISTENT);        } catch (Exception e) {            e.printStackTrace();        }    }    public void close() {        if (null != connection && null != session) {            try {                session.close();                connection.close();            } catch (JMSException e) {                e.printStackTrace();            }        }    }    public void commit() {        try {            if (null != connection && null != session)                session.commit();        } catch (JMSException e) {            e.printStackTrace();        }    }    public void sendMessage(String msg) {        try {            TextMessage message = session.createTextMessage(msg);            System.out.println("send message：" + msg);            producer.send(message);        } catch (JMSException e) {            e.printStackTrace();        }    }}